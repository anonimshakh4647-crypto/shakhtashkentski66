<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Player | IT SHAKH</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;800&display=swap" rel="stylesheet">
    <style>
        :root{ 
            --bg:#020409; --card:#0b1220; --accent:#38bdf8; --glow:0 0 35px rgba(56,189,248,.6); 
            --text-color: #fff; --header-bg: rgba(11,18,32,0.8);
        }
        body.night-mode {
            --bg: #000; --card: #030a00; --accent: #00ff41; 
            --glow: 0 0 35px rgba(0,255,65,.6); --text-color: #00ff41;
            --header-bg: rgba(0,0,0,0.9);
        }
        *{box-sizing: border-box;}
        body{ margin:0; background:var(--bg); color:var(--text-color); font-family:Inter, sans-serif; overflow-x:hidden; transition: 0.5s; }
        
        /* Matrix */
        .matrix-overlay { position: fixed; inset: 0; z-index: -1; opacity: 0; pointer-events: none; }
        body.night-mode .matrix-overlay { opacity: 1; }
        #matrixCanvas { display: block; }

        header{ padding:15px 40px; display:flex; justify-content:space-between; align-items:center; background:var(--header-bg); backdrop-filter:blur(10px); position:fixed; top:0; width:100%; z-index:100; }
        .back-link{ color:var(--accent); text-decoration:none; font-weight:bold; }

        .main-content{ max-width:1300px; margin:100px auto 40px; padding:20px; display:grid; grid-template-columns:450px 1fr; gap:40px; align-items:start; }

        .viz-box{ position:sticky; top:120px; text-align:center; background:var(--card); padding:30px; border-radius:30px; box-shadow:var(--glow); border: 1px solid rgba(255,255,255,0.05); }
        .ring{ width:280px; height:280px; border-radius:50%; margin:auto; position:relative; display:flex; align-items:center; justify-content:center; background:conic-gradient(var(--accent), #7c4dff, var(--accent)); animation:rotate 15s linear infinite; }
        .ring::after{ content:""; position:absolute; inset:6px; background:var(--bg); border-radius:50%; }
        .logo{ position:absolute; width:200px; z-index:10; transition: 0.1s; }
        @keyframes rotate{ from {transform:rotate(0)} to {transform:rotate(360deg)} }

        .bass-control { margin-top: 25px; background: rgba(56, 189, 248, 0.1); padding: 15px; border-radius: 15px; border: 1px solid var(--accent); }
        .bass-slider { width: 100%; cursor: pointer; accent-color: var(--accent); }

        .tracks-scroll{ height:80vh; overflow-y:auto; padding-right:10px; }
        .track{ background:var(--card); padding:15px; border-radius:15px; margin-bottom:12px; border: 1px solid rgba(255,255,255,0.05); }
        .track h4{ margin:0 0 10px 0; color:var(--accent); font-size: 14px; }
        audio{ width:100%; filter: invert(100%); height: 30px; }
        body.night-mode audio { filter: invert(0%) hue-rotate(90deg) brightness(1.5); }
        
        .mode-toggle { background: var(--accent); color: #000; border: none; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-weight: bold; }

        @media(max-width:900px){ .main-content{ grid-template-columns:1fr; } .viz-box{ position:relative; top:0; } }
    </style>
</head>
<body>

<div class="matrix-overlay"><canvas id="matrixCanvas"></canvas></div>

<header>
    <a href="index.html" class="back-link">‚Üê ORQAGA</a>
    <button class="mode-toggle" id="modeToggle">NIGHT MODE OFF</button>
</header>

<div class="main-content">
    <div class="viz-box">
        <div class="ring" id="ring"><img src="logo.png" class="logo" id="logo"></div>
        <h3 id="track-name" style="font-size: 16px; margin: 15px 0;">Musiqani tanlang</h3>
        <div class="bass-control">
            <label style="font-size: 12px;">BASS BOOST: <span id="bass-value">0 dB</span></label>
            <input type="range" id="bass-slider" class="bass-slider" min="0" max="30" value="0">
        </div>
    </div>

    <div class="tracks-scroll">
        <div class="track"><h4>Shakh Bass 1</h4><audio controls class="audio" data-n="Shakh Bass 1"><source src="music1.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 2</h4><audio controls class="audio" data-n="Shakh Bass 2"><source src="music2.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 3</h4><audio controls class="audio" data-n="Shakh Bass 3"><source src="music3.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 4</h4><audio controls class="audio" data-n="Shakh Bass 4"><source src="music4.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 5</h4><audio controls class="audio" data-n="Shakh Bass 5"><source src="music5.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 6</h4><audio controls class="audio" data-n="Shakh Bass 6"><source src="music6.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 7</h4><audio controls class="audio" data-n="Shakh Bass 7"><source src="music7.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 8</h4><audio controls class="audio" data-n="Shakh Bass 8"><source src="music8.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 9</h4><audio controls class="audio" data-n="Shakh Bass 9"><source src="music9.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 10</h4><audio controls class="audio" data-n="Shakh Bass 10"><source src="music10.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 11</h4><audio controls class="audio" data-n="Shakh Bass 11"><source src="music11.mp3"></audio></div>
        <div class="track"><h4>Shakh Bass 12</h4><audio controls class="audio" data-n="Shakh Bass 12"><source src="music12.mp3"></audio></div>
    </div>
</div>

<script>
    const audios = document.querySelectorAll('.audio');
    const logo = document.getElementById('logo');
    const ring = document.getElementById('ring');
    const trackName = document.getElementById('track-name');
    const bassSlider = document.getElementById('bass-slider');
    const bassValueDisplay = document.getElementById('bass-value');
    const modeToggle = document.getElementById('modeToggle');
    const body = document.body;

    let audioCtx, analyser, bassFilter, data;
    const sources = new Map();

    // Matrix Logic
    const canvas = document.getElementById('matrixCanvas');
    const ctx = canvas.getContext('2d');
    let matrixInterval;

    function drawMatrix() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#00ff41';
        ctx.font = '15px monospace';
        columns_drops.forEach((y, i) => {
            const text = String.fromCharCode(0x30A0 + Math.random() * 96);
            ctx.fillText(text, i * 20, y);
            if (y > canvas.height && Math.random() > 0.975) columns_drops[i] = 0;
            else columns_drops[i] += 20;
        });
    }

    let columns_drops = [];
    modeToggle.onclick = () => {
        body.classList.toggle('night-mode');
        if(body.classList.contains('night-mode')) {
            modeToggle.innerText = "NIGHT MODE ON";
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            columns_drops = Array(Math.floor(canvas.width / 20)).fill(0);
            matrixInterval = setInterval(drawMatrix, 50);
        } else {
            modeToggle.innerText = "NIGHT MODE OFF";
            clearInterval(matrixInterval);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
    };

    // Audio Logic
    audios.forEach(audio => {
        audio.onplay = () => {
            audios.forEach(a => { if(a !== audio) a.pause(); });
            trackName.innerText = audio.getAttribute('data-n');
            
            if(!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                bassFilter = audioCtx.createBiquadFilter();
                bassFilter.type = "lowshelf";
                bassFilter.frequency.value = 200;
                analyser = audioCtx.createAnalyser();
                data = new Uint8Array(analyser.frequencyBinCount);
                animate();
            }
            if(!sources.has(audio)) {
                const s = audioCtx.createMediaElementSource(audio);
                s.connect(bassFilter).connect(analyser).connect(audioCtx.destination);
                sources.set(audio, s);
            }
            if (audioCtx.state === 'suspended') audioCtx.resume();
        };
    });

    bassSlider.oninput = () => {
        bassValueDisplay.innerText = bassSlider.value + " dB";
        if(bassFilter) bassFilter.gain.value = bassSlider.value;
    };

    function animate() {
        requestAnimationFrame(animate);
        if(!analyser) return;
        analyser.getByteFrequencyData(data);
        let bass = data[2];
        logo.style.transform = `scale(${1 + bass/600})`;
        ring.style.boxShadow = `0 0 ${bass/1.5}px var(--accent)`;
    }
</script>
</body>
</html>